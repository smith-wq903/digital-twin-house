# 🏠 Digital Twin House

間取り図を描いて家具を配置する、ブラウザで動く3Dホームツイン。

---

## 動作確認手順

### 1. 依存パッケージのインストール（初回のみ）

```bash
npm install
```

### 2. 開発サーバーの起動

```bash
npm run dev
```

ターミナルに表示される URL（例: `http://localhost:5173`）をブラウザで開く。

---

## 使い方

### Step 1 — 間取りを描く

1. 左パネルの **「間取りエディタ」** タブを開く
2. 「**画像をアップロード**」で間取り図の画像を読み込む
3. 「**自動検出**」ボタンを押すと、画像から部屋を自動認識して3Dに反映される
   - ※ 白背景＋黒線の建築図面向け。複雑な図は手動補正を推奨
4. 「**✏ 描く**」モードで部屋名を入力してキャンバスをドラッグ → 手動で追加も可能

### Step 2 — 部屋を編集する

1. 「**✦ 編集**」モードに切り替える
2. キャンバスまたは下のリストから部屋をクリックして選択
3. **角をドラッグ** → リサイズ　**中心をドラッグ** → 移動
4. プロパティパネル（名前・X/Y・W/H）で数値入力して正確に変更
5. `Delete` キーで選択中の部屋を削除

### Step 3 — 家具を配置・編集する

1. 左パネルの **「家具」** タブを開く
2. ボタンをクリック → 原点に家具が追加される
3. 3Dビューで **家具をドラッグ** して移動（ドラッグ中はカメラが固定）
4. **矢印キー** で微調整
5. 配置済みリストで家具を選択すると **W/H/D サイズ入力欄** が表示される

### Step 4 — 計測する

1. 3Dビュー右上の **「📏 計測」** ボタンを押して計測モードをON
2. 床面の任意の点を **クリック → もう一度クリック** で2点を指定
3. 黄色のラインと距離（m）が表示される
4. 3回目クリックでリセット / ボタンを再押しで終了

グリッドの数字はメートル単位の距離を示します。2Dキャンバス左下のスケールバーも参考にしてください。

### Step 5 — 3Dを操作する

| 操作 | 動作 |
|------|------|
| 左ドラッグ | 視点を回転 |
| 右ドラッグ | 縦横に移動（パン） |
| マウスホイール | ズームイン/アウト |

### Step 6 — 保存・読み込み

- 左パネル下部の **「⬇ エクスポート」** → 現在の間取りを `floorplan-YYYY-MM-DD.json` として保存
- **「⬆ インポート」** → 保存済みのJSONを選択して間取りを完全復元

---

## 技術スタック

| ライブラリ | 用途 |
|-----------|------|
| React + Vite + TypeScript | フロントエンド基盤 |
| React Three Fiber | Three.js の React ラッパー |
| @react-three/drei | OrbitControls・Text・Grid・Line など |
| Zustand | 部屋・家具の状態管理 |

---

## ビルド（本番用）

```bash
npm run build
# dist/ フォルダに静的ファイルが生成される
```

プレビュー確認:

```bash
npm run preview
```
